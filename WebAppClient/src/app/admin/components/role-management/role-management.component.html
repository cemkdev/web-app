<div class="role-management mat-elevation-z4">
  <div class="role-insertion-side">
    <form [formGroup]="roleForm">
      <div class="form-container">
        <div class="form-title">
          <mat-icon class="material-icons-outlined">add_moderator</mat-icon>
          <span class="form-title-span">Add New Role</span>
        </div>
        <div class="form-content">
          <!-- NAME -->
          <mat-form-field>
            <mat-label>Name</mat-label>
            <input matInput formControlName="name" />
            <mat-icon
              matSuffix
              *ngIf="
                roleForm.get('name')?.invalid && roleForm.get('name')?.touched
              "
              >error_outline</mat-icon
            >
            <mat-icon matSuffix>badge</mat-icon>
            <mat-error
              *ngIf="
                roleForm.get('name')?.invalid && roleForm.get('name')?.touched
              "
              >Name is required.</mat-error
            >
          </mat-form-field>

          <!-- Is Admin -->
          <mat-checkbox formControlName="isAdmin" color="primary">
            Is Admin Role?
          </mat-checkbox>
          <small class="text-muted">
            If checked, this role will have access to admin panel endpoints.
          </small>
        </div>
        <div class="form-submit">
          <button
            mat-flat-button
            color="dismiss"
            disabled
            *ngIf="!roleForm.valid"
          >
            Create
          </button>
          <button
            mat-raised-button
            color="success"
            (click)="createRole()"
            *ngIf="roleForm.valid"
          >
            Create
          </button>
        </div>
      </div>
    </form>
  </div>
  <div class="role-list-side">
    <section class="table-container role-table" tabindex="0">
      <!-- Table Header -->
      <div class="table-header">
        <div class="role-table-title">
          <mat-icon>security</mat-icon>
          <span class="title-span">Roles</span>
        </div>
        <!-- Delete Selected Items Button -->
        <button
          mat-mini-fab
          class="delete-multiple-item"
          color="error"
          (click)="deleteSelectedRoles()"
          *ngIf="selection.selected.length != 0"
        >
          <mat-icon>playlist_remove</mat-icon>
        </button>
        <button
          mat-mini-fab
          class="delete-multiple-item"
          color="dismiss"
          disabled
          *ngIf="selection.selected.length == 0"
        >
          <mat-icon>playlist_remove</mat-icon>
        </button>
      </div>

      <!-- Scrollable Table Row Section -->
      <div class="table-scroll-wrapper">
        <table mat-table [dataSource]="dataSource">
          <!-- Checkbox Column -->
          <ng-container matColumnDef="select">
            <th mat-header-cell *matHeaderCellDef class="select">
              <mat-checkbox
                (change)="$event ? toggleAllRows() : null"
                [checked]="selection.hasValue() && isAllSelected()"
                [indeterminate]="selection.hasValue() && !isAllSelected()"
                [aria-label]="checkboxLabel()"
              >
              </mat-checkbox>
            </th>
            <td mat-cell *matCellDef="let row" class="select">
              <mat-checkbox
                (click)="$event.stopPropagation()"
                (change)="$event ? selection.toggle(row) : null"
                [checked]="selection.isSelected(row)"
                [aria-label]="checkboxLabel(row)"
              >
              </mat-checkbox>
            </td>
          </ng-container>

          <!-- Index Column -->
          <ng-container matColumnDef="index">
            <th mat-header-cell *matHeaderCellDef>
              <!-- <span *ngIf="selection.selected.length != 0">({{selection.selected.length}})</span> -->
            </th>
            <td
              mat-cell
              *matCellDef="let element; let i = index"
              class="start-column"
            >
              <span>{{ i + 1 }}</span>
            </td>
          </ng-container>

          <!-- Name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef class="name">Name</th>
            <td mat-cell *matCellDef="let element" class="name">
              <span>{{ element.name }}</span>
            </td>
          </ng-container>

          <!-- Is Admin Column -->
          <ng-container matColumnDef="isAdmin">
            <th mat-header-cell *matHeaderCellDef>User Type</th>
            <td mat-cell *matCellDef="let element" class="is-admin">
              <span *ngIf="element.isAdmin" class="admin">
                <mat-icon>admin_panel_settings</mat-icon> Admin
              </span>
              <span *ngIf="!element.isAdmin">
                <mat-icon>person</mat-icon> User
              </span>
            </td>
          </ng-container>

          <!-- Edit Button Column -->
          <ng-container matColumnDef="edit">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element" class="set-button">
              <button
                mat-mini-fab
                class="no-elevation small"
                color="warning"
                (click)="updateRole(element.id)"
              >
                <mat-icon
                  matTooltip="Change Role Name"
                  matTooltipPosition="above"
                  >edit</mat-icon
                >
              </button>
            </td>
          </ng-container>

          <!-- Delete Button Column -->
          <ng-container matColumnDef="delete">
            <th mat-header-cell *matHeaderCellDef></th>
            <td
              mat-cell
              *matCellDef="let element"
              [id]="element.id"
              class="set-button end-column"
            >
              <button
                mat-mini-fab
                class="no-elevation small"
                color="error"
                appDelete
                controller="roles"
                (callback)="getRoles()"
              >
                <mat-icon matTooltip="Delete Role" matTooltipPosition="above"
                  >delete</mat-icon
                >
              </button>
            </td>
          </ng-container>

          <tr
            mat-header-row
            *matHeaderRowDef="displayedColumns; sticky: true"
          ></tr>
          <tr
            mat-row
            *matRowDef="let row; columns: displayedColumns"
            [attr.data-id]="row.id"
          ></tr>

          <!-- Row shown when there is no matching data. -->
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="4">No data matching the filter.</td>
          </tr>
        </table>
      </div>

      <!-- Paginator -->
      <div class="paginator">
        <span class="paginator-text">
          <span *ngIf="selection.selected.length != 0"
            >{{ selection.selected.length }} selected -</span
          >
          {{ totalItemCount }} item found
        </span>
      </div>
    </section>
  </div>
</div>
